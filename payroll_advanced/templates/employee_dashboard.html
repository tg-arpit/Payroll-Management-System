{% extends "base.html" %}

{% block title %}Employee Dashboard{% endblock %}

{% block content %}
<!-- Welcome Section -->
<div class="card">
    <h2 style="color: #667eea; margin-bottom: 10px;">ğŸ‘‹ Welcome, {{ employee.name }}!</h2>
    <p style="color: #666;">Employee ID: <strong>{{ employee.emp_id }}</strong></p>
</div>

<!-- Stats Cards -->
<div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 30px;">
    <!-- Days Present -->
    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 15px; text-align: center;">
        <h3 style="font-size: 42px; margin-bottom: 10px;">{{ days_present|round|int }}</h3>
        <p style="font-size: 16px;">Days Present (This Month)</p>
    </div>
    
    <!-- Base Salary -->
    <div style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; padding: 30px; border-radius: 15px; text-align: center;">
        <h3 style="font-size: 42px; margin-bottom: 10px;">â‚¹{{ "%.2f"|format(employee.base_salary) }}</h3>
        <p style="font-size: 16px;">Base Salary</p>
    </div>
    
    <!-- Department -->
    <div style="background: linear-gradient(135deg, #ffc107 0%, #ff6b6b 100%); color: white; padding: 30px; border-radius: 15px; text-align: center;">
        <h3 style="font-size: 28px; margin-bottom: 10px;">{{ employee.department or 'General' }}</h3>
        <p style="font-size: 16px;">Department</p>
    </div>
    
    <!-- Total Payslips -->
    <div style="background: linear-gradient(135deg, #17a2b8 0%, #138496 100%); color: white; padding: 30px; border-radius: 15px; text-align: center;">
        <h3 style="font-size: 42px; margin-bottom: 10px;">{{ payslips|length }}</h3>
        <p style="font-size: 16px;">Total Payslips</p>
    </div>
</div>

<!-- Quick Actions -->
<div class="card">
    <h3 style="margin-bottom: 20px;">âš¡ Quick Actions</h3>
    
    <div style="display: flex; gap: 15px;">
        <a href="{{ url_for('employee_attendance') }}" class="btn btn-primary" style="flex: 1; text-align: center; padding: 15px;">
            ğŸ“… View Attendance
        </a>
        
        <a href="{{ url_for('employee_payslips') }}" class="btn btn-primary" style="flex: 1; text-align: center; padding: 15px;">
            ğŸ’³ View Payslips
        </a>
    </div>
</div>

<!-- Current Month Attendance Summary -->
<div class="card">
    <h3 style="margin-bottom: 20px;">ğŸ“Š Current Month Attendance Summary</h3>
    
    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 20px;">
        <div style="background: #d4edda; padding: 20px; border-radius: 10px; text-align: center; border-left: 4px solid #28a745;">
            <h4 style="font-size: 28px; color: #28a745; margin-bottom: 5px;">
                {{ attendance_records|selectattr('status', 'equalto', 'Present')|list|length }}
            </h4>
            <p style="color: #666;">Present Days</p>
        </div>
        
        <div style="background: #f8d7da; padding: 20px; border-radius: 10px; text-align: center; border-left: 4px solid #dc3545;">
            <h4 style="font-size: 28px; color: #dc3545; margin-bottom: 5px;">
                {{ attendance_records|selectattr('status', 'equalto', 'Absent')|list|length }}
            </h4>
            <p style="color: #666;">Absent Days</p>
        </div>
        
        <div style="background: #fff3cd; padding: 20px; border-radius: 10px; text-align: center; border-left: 4px solid #ffc107;">
            <h4 style="font-size: 28px; color: #ffc107; margin-bottom: 5px;">
                {{ attendance_records|selectattr('status', 'equalto', 'Leave')|list|length }}
            </h4>
            <p style="color: #666;">Leaves</p>
        </div>
        
        <div style="background: #d1ecf1; padding: 20px; border-radius: 10px; text-align: center; border-left: 4px solid #17a2b8;">
            <h4 style="font-size: 28px; color: #17a2b8; margin-bottom: 5px;">
                {{ attendance_records|selectattr('status', 'equalto', 'Half-Day')|list|length }}
            </h4>
            <p style="color: #666;">Half Days</p>
        </div>
    </div>
    
    {% if attendance_records %}
    <div style="background: #e7f3ff; padding: 15px; border-radius: 8px; border-left: 4px solid #667eea;">
        <strong>â„¹ï¸ Note:</strong> Your attendance is updated by the administrator. 
        You have <strong style="color: #28a745;">{{ days_present|round|int }}</strong> effective working days this month.
    </div>
    {% else %}
    <p style="color: #999; text-align: center; padding: 20px;">
        No attendance records yet for this month.
    </p>
    {% endif %}
</div>

<!-- Recent Payslips -->
{% if payslips %}
<div class="card">
    <h3 style="margin-bottom: 20px;">ğŸ’³ Recent Payslips</h3>
    
    <table>
        <thead>
            <tr>
                <th>Month</th>
                <th>Gross Salary</th>
                <th>Net Salary</th>
                <th>Status</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for payslip in payslips %}
            <tr>
                <td><strong>{{ payslip.month }}</strong></td>
                <td>â‚¹{{ "%.2f"|format(payslip.gross_salary) }}</td>
                <td><strong style="color: #28a745;">â‚¹{{ "%.2f"|format(payslip.net_salary) }}</strong></td>
                <td>
                    <span style="background: #d4edda; color: #155724; padding: 5px 10px; border-radius: 5px;">
                        {{ payslip.status }}
                    </span>
                </td>
                <td>
                    <a href="{{ url_for('download_payslip', trans_id=payslip.trans_id) }}" 
                       class="btn btn-primary" 
                       style="padding: 6px 12px; font-size: 14px;">
                        ğŸ“¥ Download
                    </a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    <div style="text-align: center; margin-top: 20px;">
        <a href="{{ url_for('employee_payslips') }}" class="btn btn-primary">
            View All Payslips â†’
        </a>
    </div>
</div>
{% endif %}
{% endblock %}