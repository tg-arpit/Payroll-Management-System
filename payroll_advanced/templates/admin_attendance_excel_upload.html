{% extends "base.html" %}

{% block title %}Upload Attendance Excel{% endblock %}

{% block content %}
<div style="max-width: 800px; margin: 0 auto;">
    <div class="card">
        <h2 style="color: #667eea; margin-bottom: 30px;">üì§ Upload Attendance via Excel</h2>
        
        <!-- Instructions -->
        <div style="background: #e7f3ff; padding: 20px; border-radius: 5px; margin-bottom: 30px;">
            <h3 style="margin-bottom: 15px;">üìã Instructions:</h3>
            <ol style="margin-left: 20px; line-height: 1.8;">
                <li>Download the Excel template below</li>
                <li>Fill in attendance details:
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>emp_id</strong> - Employee ID (e.g., EMP001)</li>
                        <li><strong>date</strong> - Date (YYYY-MM-DD format, e.g., 2026-01-15)</li>
                        <li><strong>status</strong> - Present, Absent, Leave, or Half-Day</li>
                        <li><strong>check_in</strong> - Check-in time (HH:MM, optional)</li>
                        <li><strong>remarks</strong> - Any notes (optional)</li>
                    </ul>
                </li>
                <li>Upload the completed Excel file</li>
            </ol>
        </div>
        
        <!-- Download Template -->
        <div style="background: #fff3cd; padding: 20px; border-radius: 5px; margin-bottom: 30px;">
            <h3 style="margin-bottom: 15px;">üì• Step 1: Download Template</h3>
            <button class="btn btn-secondary" onclick="downloadTemplate()">
                üì• Download Excel Template
            </button>
        </div>
        
        <!-- Upload File -->
        <div style="background: #d4edda; padding: 20px; border-radius: 5px; margin-bottom: 30px;">
            <h3 style="margin-bottom: 15px;">üì§ Step 2: Upload Filled Excel</h3>
            
            <form method="POST" enctype="multipart/form-data">
                <div class="form-group">
                    <input type="file" 
                           name="file" 
                           accept=".xlsx,.xls" 
                           required
                           style="padding: 20px; border: 2px dashed #28a745; background: white; border-radius: 5px; width: 100%;">
                </div>
                
                <button type="submit" class="btn btn-success" style="width: 100%; margin-top: 15px;">
                    üì§ Upload & Process
                </button>
            </form>
        </div>
        
        <div style="text-align: center;">
            <a href="{{ url_for('admin_attendance') }}" class="btn btn-secondary">‚Üê Back to Attendance</a>
        </div>
    </div>
</div>

<script>
function downloadTemplate() {
    // Create CSV template
    const csvContent = `emp_id,date,status,check_in,remarks
EMP001,2026-01-15,Present,09:00,
EMP002,2026-01-15,Absent,,Sick leave
EMP003,2026-01-15,Half-Day,09:00,Left early
EMP004,2026-01-15,Leave,,Annual leave`;
    
    const blob = new Blob([csvContent], { type: 'text/csv' });
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'attendance_template.csv';
    a.click();
    window.URL.revokeObjectURL(url);
}
</script>
{% endblock %}