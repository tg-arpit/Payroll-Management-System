{% extends "base.html" %}

{% block title %}Bulk Upload{% endblock %}

{% block content %}
<div style="max-width: 800px; margin: 0 auto;">
    <div class="card">
        <h2 style="color: #667eea; margin-bottom: 30px;">üì§ Bulk Employee Upload</h2>
        
        <div style="background: #e7f3ff; padding: 20px; border-radius: 5px; margin-bottom: 30px;">
            <h3 style="margin-bottom: 15px;">üìã Instructions:</h3>
            <ol style="margin-left: 20px; line-height: 1.8;">
                <li>Download the Excel template below</li>
                <li>Fill in employee details (name, email, phone, department, designation, joining_date, base_salary)</li>
                <li>Upload the completed Excel file</li>
                <li>System will automatically send credentials to all employees</li>
            </ol>
        </div>
        
        <!-- Download Template -->
        <div style="background: #fff3cd; padding: 20px; border-radius: 5px; margin-bottom: 30px;">
            <h3 style="margin-bottom: 15px;">üì• Step 1: Download Template</h3>
            <p style="margin-bottom: 15px;">Download this Excel template and fill employee details:</p>
            
            <div style="background: white; padding: 15px; border-radius: 5px; border: 1px solid #ddd;">
                <strong>Required Columns:</strong><br>
                <code style="background: #f5f5f5; padding: 2px 5px; margin: 2px;">name</code>
                <code style="background: #f5f5f5; padding: 2px 5px; margin: 2px;">email</code>
                <code style="background: #f5f5f5; padding: 2px 5px; margin: 2px;">phone</code>
                <code style="background: #f5f5f5; padding: 2px 5px; margin: 2px;">department</code>
                <code style="background: #f5f5f5; padding: 2px 5px; margin: 2px;">designation</code>
                <code style="background: #f5f5f5; padding: 2px 5px; margin: 2px;">joining_date</code>
                <code style="background: #f5f5f5; padding: 2px 5px; margin: 2px;">base_salary</code>
            </div>
            
            <button class="btn btn-secondary" style="margin-top: 15px;" onclick="downloadTemplate()">
                üì• Download Template
            </button>
        </div>
        
        <!-- Upload File -->
        <div style="background: #d4edda; padding: 20px; border-radius: 5px; margin-bottom: 30px;">
            <h3 style="margin-bottom: 15px;">üì§ Step 2: Upload Excel File</h3>
            
            <form method="POST" enctype="multipart/form-data">
                <div class="form-group">
                    <input type="file" 
                           name="file" 
                           accept=".xlsx,.xls" 
                           required
                           style="padding: 20px; border: 2px dashed #28a745; background: white;">
                </div>
                
                <button type="submit" class="btn btn-success" style="width: 100%;">
                    üì§ Upload & Process
                </button>
            </form>
        </div>
        
        <div style="text-align: center;">
            <a href="{{ url_for('admin_employees') }}" class="btn btn-secondary">‚Üê Back to Employees</a>
        </div>
    </div>
</div>

<script>
function downloadTemplate() {
    // Create sample CSV template
    const csvContent = "name,email,phone,department,designation,joining_date,base_salary\n" +
                      "John Doe,john@example.com,9876543210,Engineering,Software Engineer,2026-01-01,50000\n" +
                      "Jane Smith,jane@example.com,9876543211,HR,HR Manager,2026-01-01,60000";
    
    const blob = new Blob([csvContent], { type: 'text/csv' });
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'employee_template.csv';
    a.click();
    window.URL.revokeObjectURL(url);
}
</script>
{% endblock %}